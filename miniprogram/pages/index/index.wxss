/* ================= 全局 & 基础 ================= */
page { background-color: #F9F9F9; height: 100%; overflow: hidden; }
.index-page { height: 100%; display: flex; flex-direction: column; padding: 120rpx 60rpx 80rpx; box-sizing: border-box; position: relative; }

/* 消失动画 */
.fade-out { opacity: 0; transition: opacity 0.4s ease; }

/* 头部底部样式保持不变 */
.header-section { text-align: center; transition: 0.4s; }
.main-title { font-size: 64rpx; font-weight: 800; color: #1d1d1f; }
.sub-title { font-size: 24rpx; font-weight: 600; color: #86868b; letter-spacing: 6rpx; }
.footer-section { transition: 0.4s; }
.loc-grid { display: flex; gap: 20rpx; justify-content: center; }
.chip { background: #fff; padding: 20rpx 30rpx; border-radius: 20rpx; display: flex; align-items: center; gap: 10rpx; font-size: 26rpx; font-weight: 600; box-shadow: 0 4rpx 10rpx rgba(0,0,0,0.05); }
.status.green { width: 12rpx; height: 12rpx; background: #34c759; border-radius: 50%; }

.tool-label { font-size: 20rpx; color: #ccc; text-align: center; margin-bottom: 30rpx; letter-spacing: 2rpx; font-weight: 600; }

/* ================= 舞台区域 ================= */
.hero-section {
  flex: 1; display: flex; justify-content: center; align-items: center;
  position: relative; width: 100%;
}

/* --- 文字轨道 --- */
.text-track {
  position: absolute;
  top: 50%; left: 0; width: 100%;
  transform: translateY(-50%);
  display: flex; 
  justify-content: center; 
  gap: 16rpx; /* 字间距稍微拉开一点点，配合滚动距离 */
  z-index: 120; /* 文字在最上层，在遮罩层上方 */
  padding-left: 10rpx;
}

.char {
  font-size: 40rpx; font-weight: 900; color: #1d1d1f;
  opacity: 0; 
  transform: scale(0) translateY(20rpx); /* 初始状态：压缩在地下 */
  transform-origin: bottom center;
}

/* 文字弹出动画：更Q弹的效果 */
@keyframes popChar {
  0% { opacity: 0; transform: scale(0) translateY(20rpx); }
  50% { opacity: 1; transform: scale(1.4) translateY(-10rpx); } /* 冲出来 */
  80% { transform: scale(0.9) translateY(0); } /* 回弹一下 */
  100% { opacity: 1; transform: scale(1) translateY(0); }
}

/* 
   关键调整：时间配合
   齿轮向右滚总时长设定为 1.6s
   文字必须在齿轮滚过对应位置后才出现
   延迟时间要足够长，确保齿轮先经过
*/
.index-page .char-1 { animation: popChar 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) 0.5s forwards; } /* M - 齿轮滚过M后 */
.index-page .char-2 { animation: popChar 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) 0.7s forwards; } /* T - 齿轮滚过T后 */
.index-page .char-3 { animation: popChar 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) 0.9s forwards; } /* 引 - 齿轮滚过引后 */
.index-page .char-4 { animation: popChar 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) 1.1s forwards; } /* 领 - 齿轮滚过领后 */
.index-page .char-5 { animation: popChar 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) 1.3s forwards; } /* 创 - 齿轮滚过创后 */
.index-page .char-6 { animation: popChar 0.5s cubic-bezier(0.34, 1.56, 0.64, 1) 1.5s forwards; } /* 新 - 齿轮滚过新后 */

/* --- 主角：从水滴到齿轮 --- */
.liquid-btn {
  width: 360rpx; height: 360rpx;
  background: #F9F9F9;
  border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;
  box-shadow: 24rpx 24rpx 60rpx rgba(174, 174, 192, 0.4), -24rpx -24rpx 60rpx rgba(255, 255, 255, 1);
  display: flex; justify-content: center; align-items: center;
  position: absolute; z-index: 100;
  animation: morph 3.5s ease-in-out infinite;
  transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.btn-text { font-size: 32rpx; font-weight: 600; letter-spacing: 6rpx; color: #666; mix-blend-mode: multiply; }
.highlight-dot { width: 40rpx; height: 20rpx; background: rgba(255,255,255,0.8); border-radius: 50%; position: absolute; top: 60rpx; left: 80rpx; transform: rotate(-45deg); filter: blur(2rpx); transition: opacity 0.2s; }

/* 齿轮内部结构 (默认透明) */
.gear-shape {
  width: 100%; height: 100%; position: absolute; opacity: 0; transition: opacity 0.3s;
  display: flex; justify-content: center; align-items: center;
}
.gear-shape .teeth {
  width: 100%; height: 100%; border-radius: 50%;
  border: 10rpx dashed #555; /* 深色虚线做齿牙 */
  box-sizing: border-box;
}
.gear-shape .hub {
  position: absolute; width: 40%; height: 40%; background: #555; border-radius: 50%;
}

/* === Step 1: 变成小齿轮 (中间) === */
.liquid-btn.step-1 {
  width: 70rpx; height: 70rpx; /* 尺寸缩小 */
  border-radius: 50%;
  box-shadow: 4rpx 4rpx 12rpx rgba(0,0,0,0.1);
  animation: none; /* 停止蠕动 */
}
.liquid-btn.step-1 .btn-text, .liquid-btn.step-1 .highlight-dot { opacity: 0; }
.liquid-btn.step-1 .gear-shape { opacity: 1; }

/* === Step 2: 向左滚 (蓄力) === */
.liquid-btn.step-2 {
  width: 70rpx; height: 70rpx; border-radius: 50%;
  animation: none;
  /* 移动动画 */
  animation: rollToLeft 0.8s cubic-bezier(0.5, 0, 0.5, 1) forwards;
}
.liquid-btn.step-2 .gear-shape { opacity: 1; animation: spinLeft 0.8s cubic-bezier(0.5, 0, 0.5, 1) forwards; }
.liquid-btn.step-2 .btn-text, .liquid-btn.step-2 .highlight-dot { display: none; }

/* === Step 3: 向右滚 (冲刺) - 调整时长 === */
.liquid-btn.step-3 {
  width: 70rpx; height: 70rpx; border-radius: 50%;
  /* 
     时长调整为 1.6s
     timing-function 改为 ease-in-out 让启动和停止更自然，
     或者 linear 保持匀速，配合文字弹出节奏。
     这里推荐 cubic-bezier 让它有个加速过程
  */
  animation: rollToRight 1.6s cubic-bezier(0.45, 0.05, 0.55, 0.95) forwards; 
}
.liquid-btn.step-3 .gear-shape { opacity: 1; animation: spinRight 1.6s cubic-bezier(0.45, 0.05, 0.55, 0.95) forwards; }
.liquid-btn.step-3 .btn-text, .liquid-btn.step-3 .highlight-dot { display: none; }

/* === Step 4: 停留展示 (等待状态) === */
/* 这个状态下，齿轮保持在最右边，不做任何动作，给用户看文字的时间 */
.liquid-btn.step-4 {
  width: 70rpx; height: 70rpx; border-radius: 50%;
  animation: none;
  /* 必须手动固定在动画结束的位置，否则 animation remove 后会跳回原位 */
  /* rollToRight 的终点是 translateX(280rpx) */
  transform: translateX(280rpx); 
}
.liquid-btn.step-4 .gear-shape { 
  opacity: 1; 
  transform: rotate(720deg); /* 保持旋转结束的角度 */
}
.liquid-btn.step-4 .btn-text, .liquid-btn.step-4 .highlight-dot { display: none; }

/* === Step 5: 掉落 (优化版) === */
.liquid-btn.step-5 {
  width: 70rpx; height: 70rpx; border-radius: 50%;
  transform: translateX(280rpx); /* 保持水平位置不变 */
  /* 
     时长 0.8s 足够了
     cubic-bezier(0.6, -0.28, 0.735, 0.045) 是一个类似"先往上弹一下再掉下去"的物理曲线
     或者拆分 keyframes 来做更精准控制，下面 keyframes 我们手动写物理逻辑，这里用 ease-in 加速下落
  */
  animation: fallDown 0.8s cubic-bezier(0.55, 0.055, 0.675, 0.19) forwards;
}

/* 保持内部形状可见 */
.liquid-btn.step-5 .gear-shape { opacity: 1; }

/* 隐藏不需要的元素 */
.liquid-btn.step-5 .btn-text, .liquid-btn.step-5 .highlight-dot { display: none; }

/* --- 动画关键帧 --- */
@keyframes morph {
  0% { border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%; }
  50% { border-radius: 30% 60% 70% 40% / 50% 60% 30% 60%; }
  100% { border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%; }
}

/* 向左滚：从中间(0) 到 左侧边缘(-300rpx) */
@keyframes rollToLeft {
  from { transform: translateX(0); }
  to { transform: translateX(-300rpx); }
}
@keyframes spinLeft { from { transform: rotate(0); } to { transform: rotate(-360deg); } }

/* rollToRight 终点位置确认 */
@keyframes rollToRight {
  from { transform: translateX(-300rpx); }
  to { transform: translateX(280rpx); } 
}
@keyframes spinRight { from { transform: rotate(-360deg); } to { transform: rotate(720deg); } }

/* 优化后的掉落关键帧：腾空 -> 加速坠落 */
@keyframes fallDown {
  0% { 
    /* 初始状态：接上一步的结尾 */
    transform: translateX(280rpx) translateY(0) rotate(720deg) scale(1); 
    opacity: 1;
  }
  
  /* 30%的时间点：向上腾空，做一个"起跳"的动作 */
  30% { 
    /* 往上跳得更高，同时稍微反向旋转一点(蓄力感)，或者减速旋转 */
    transform: translateX(280rpx) translateY(-120rpx) rotate(700deg) scale(1.1); 
    opacity: 1;
    /* 此时 animation-timing-function 应该是减速 (ease-out) */
  }
  /* 100%的时间点：掉出屏幕 */
  100% { 
    /* 
       translateY 设为 600rpx 或更大，确保完全掉出视线
       rotate 设为 1000deg+，下落时旋转加速
    */
    transform: translateX(280rpx) translateY(800rpx) rotate(1080deg) scale(0.6); 
    opacity: 0; /* 最后完全消失 */
  }
}

/* ================= 遮罩层（布的效果） ================= */
.curtain-mask {
  position: fixed;
  top: 50%; /* 文字水平线位置 */
  left: 0;
  right: 0;
  bottom: 0;
  background: linear-gradient(to bottom, 
    rgba(249, 249, 249, 0) 0%,
    rgba(249, 249, 249, 0.4) 5%,
    rgba(249, 249, 249, 0.9) 15%,
    rgba(249, 249, 249, 1) 25%
  );
  z-index: 110; /* 在齿轮(100)上方，文字(120)下方，能遮挡齿轮 */
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.4s ease;
}

.curtain-mask.active {
  opacity: 1; /* 激活时显示遮罩，齿轮跳到布后面 */
}

